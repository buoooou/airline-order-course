services:
  database:
    image: mysql:8.0
    container_name: airline-mysql-db
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: airlineTest1234
      MYSQL_DATABASE: myqppdb
      MYSQL_USER: myappuser
      MYSQL_PASSWORD: airlineTest1234
    ports:
      - 3306:3306 
    volumes:
      - db-data:/var/lib/mysql
    networks:
      - app-network

app:
  image: airline-order-course:latest
  container_name: airline-app
  restart: always
  ports:
    - 8080:8080
  depends_on:
    - database
  environment:
    - SPRING_DATASOURCE_URL=jdbc:mysql://database:3306/myqppdb?useSSL=false&allowPublicKeyRetrieval=true
    - SPRING_DATASOURCE_USERNAME=myappuser
    - SPRING_DATASOURCE_PASSWORD=airlineTest1234
  networks:
    - app-network

volumes:
  db-data:  

networks:
  app-network: