<nz-page-header [nzTitle]="pageTitle" nzBackIcon="">
  <nz-page-header-extra>
    <button
      nz-button
      nzType="primary"
      nzDanger
      (click)="logout()"
      aria-label="退出登录"
      title="退出登录"
    >
      <span nz-icon nzType="logout"></span>
      退出登录
    </button>
  </nz-page-header-extra>
</nz-page-header>

<nz-card class="order-card">
  <div class="search-bar">
    <input
      nz-input
      placeholder="输入订单号搜索"
      [(ngModel)]="searchValue"
      class="search-input"
    />
    <button nz-button nzType="primary" (click)="loadOrders()" title="搜索订单">
      <span nz-icon nzType="search"></span>
    </button>
  </div>

  <nz-table
    #orderTable
    [nzData]="orders"
    [nzLoading]="isLoading"
    class="order-table"
  >
    <thead>
      <tr>
        <th>订单号</th>
        <th>金额</th>
        <th>状态</th>
        <th>创建时间</th>
        <th>操作</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let order of orderTable.data">
        <td>{{ order.orderNumber }}</td>
        <td class="font-medium">{{ order.amount | currency : "CNY" }}</td>
        <td>
          <nz-tag [nzColor]="statusColorMap[order.status]">
            {{ statusTextMap[order.status] }}
          </nz-tag>
        </td>
        <td>{{ order.createTime | date : "yyyy-MM-dd HH:mm" }}</td>
        <td>
          <div class="action-buttons">
            <button
              *ngIf="order.status === 'PENDING_PAYMENT'"
              nz-button
              nzType="primary"
              nzSize="small"
              (click)="payOrder(order.id)"
            >
              支付
            </button>
            <button
              *ngIf="order.status !== 'CANCELED' && order.status !== 'TICKETED'"
              nz-button
              nzType="default"
              nzSize="small"
              nzDanger
              (click)="cancelOrder(order.id)"
            >
              取消
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </nz-table>
</nz-card>
