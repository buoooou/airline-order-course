# ğŸš€ å‰ç«¯éƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—æä¾›äº†ä¸¤ç§å‰ç«¯éƒ¨ç½²æ–¹å¼ï¼š
1. **å¿«é€Ÿéƒ¨ç½²**ï¼šç›´æ¥ä¸Šä¼ æºç åˆ°æœåŠ¡å™¨æ„å»ºï¼ˆé€‚åˆå¼€å‘æµ‹è¯•ï¼‰
2. **ç”Ÿäº§éƒ¨ç½²**ï¼šDockeré•œåƒæ–¹å¼ï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰

## ğŸ¯ æ–¹å¼ä¸€ï¼šå¿«é€Ÿéƒ¨ç½²ï¼ˆå½“å‰è¿›è¡Œä¸­ï¼‰

### æ­¥éª¤ï¼š
1. âœ… ä¸Šä¼ å‰ç«¯æºç åˆ°æœåŠ¡å™¨ï¼ˆè¿›è¡Œä¸­ï¼‰
2. ğŸ”„ åœ¨æœåŠ¡å™¨ä¸Šæ„å»ºAngularåº”ç”¨
3. ğŸ”„ é…ç½®Nginxä»£ç†
4. ğŸ”„ å¯åŠ¨å‰ç«¯æœåŠ¡

### å®Œæˆä¸Šä¼ åæ‰§è¡Œï¼š
```bash
# SSHåˆ°æœåŠ¡å™¨
ssh -i fuser23-airline-order-keypair.pem ec2-user@18.116.240.81

# è¿›å…¥å‰ç«¯ç›®å½•
cd /opt/airline-order/frontend

# å®‰è£…ä¾èµ–
npm install

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# é…ç½®Nginxå¹¶å¯åŠ¨
```

## ğŸ­ æ–¹å¼äºŒï¼šç”Ÿäº§Dockeréƒ¨ç½²ï¼ˆæ¨èï¼‰

### æ–‡ä»¶ç»“æ„ï¼š
```
airline-order-course/
â”œâ”€â”€ frontend.Dockerfile              # å‰ç«¯Dockeræ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.production.yml    # ç”Ÿäº§ç¯å¢ƒç¼–æ’
â”œâ”€â”€ safe-frontend-deploy.sh          # å®‰å…¨éƒ¨ç½²è„šæœ¬
â””â”€â”€ FRONTEND_DEPLOYMENT_GUIDE.md     # æœ¬æŒ‡å—
```

### ğŸ”§ æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

#### 1. frontend.Dockerfile
- **å¤šé˜¶æ®µæ„å»º**ï¼šå…ˆç”¨Node.jsæ„å»ºï¼Œå†ç”¨NginxæœåŠ¡
- **ä¼˜åŒ–é•œåƒå¤§å°**ï¼šæœ€ç»ˆé•œåƒåªåŒ…å«æ„å»ºäº§ç‰©å’ŒNginx
- **ç”Ÿäº§å°±ç»ª**ï¼šåŒ…å«æ‰€æœ‰å¿…è¦çš„é…ç½®

#### 2. safe-frontend-deploy.sh
- **å®‰å…¨éƒ¨ç½²**ï¼šåŒ…å«å›æ»šæœºåˆ¶
- **å¥åº·æ£€æŸ¥**ï¼šè‡ªåŠ¨éªŒè¯éƒ¨ç½²æ˜¯å¦æˆåŠŸ
- **å¤‡ä»½ç®¡ç†**ï¼šè‡ªåŠ¨å¤‡ä»½å’Œæ¸…ç†æ—§ç‰ˆæœ¬
- **é”™è¯¯å¤„ç†**ï¼šéƒ¨ç½²å¤±è´¥è‡ªåŠ¨å›æ»š

#### 3. docker-compose.production.yml
- **å®Œæ•´æ ˆéƒ¨ç½²**ï¼šMySQL + åç«¯ + å‰ç«¯
- **ç½‘ç»œéš”ç¦»**ï¼šä½¿ç”¨Dockerç½‘ç»œ
- **æŒä¹…åŒ–å­˜å‚¨**ï¼šæ•°æ®åº“æ•°æ®æŒä¹…åŒ–

### ğŸš€ æ‰§è¡Œç”Ÿäº§éƒ¨ç½²

```bash
# 1. ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•
cd airline-order-course

# 2. æ‰§è¡Œå®‰å…¨éƒ¨ç½²è„šæœ¬
./safe-frontend-deploy.sh

# 3. å¦‚æœéœ€è¦å›æ»š
./safe-frontend-deploy.sh --rollback
```

### ğŸ“Š éƒ¨ç½²æµç¨‹

```mermaid
graph TD
    A[å¼€å§‹éƒ¨ç½²] --> B[é¢„æ£€æŸ¥]
    B --> C[å¤‡ä»½å½“å‰ç‰ˆæœ¬]
    C --> D[æ„å»ºDockeré•œåƒ]
    D --> E[æ¨é€åˆ°ECR]
    E --> F[éƒ¨ç½²åˆ°EC2]
    F --> G[å¥åº·æ£€æŸ¥]
    G --> H{æ£€æŸ¥é€šè¿‡?}
    H -->|æ˜¯| I[éƒ¨ç½²æˆåŠŸ]
    H -->|å¦| J[è‡ªåŠ¨å›æ»š]
    J --> K[å›æ»šå®Œæˆ]
```

## ğŸ” éƒ¨ç½²åéªŒè¯

### è®¿é—®åœ°å€ï¼š
- **å‰ç«¯åº”ç”¨**: http://18.116.240.81
- **åç«¯API**: http://18.116.240.81:8080/api/flights
- **APIæ–‡æ¡£**: http://18.116.240.81:8080/swagger-ui/index.html

### éªŒè¯æ­¥éª¤ï¼š
1. **å‰ç«¯åŠ è½½**ï¼šè®¿é—®ä¸»é¡µï¼Œæ£€æŸ¥é¡µé¢æ˜¯å¦æ­£å¸¸åŠ è½½
2. **APIè¿æ¥**ï¼šæµ‹è¯•ç™»å½•åŠŸèƒ½ï¼ŒéªŒè¯å‰åç«¯é€šä¿¡
3. **åŠŸèƒ½æµ‹è¯•**ï¼šæµ‹è¯•ä¸»è¦ä¸šåŠ¡åŠŸèƒ½

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜ï¼š

#### 1. æ„å»ºå¤±è´¥
```bash
# æ£€æŸ¥Node.jsç‰ˆæœ¬
node --version  # åº”è¯¥æ˜¯ 18.x

# æ£€æŸ¥ä¾èµ–
npm install --verbose
```

#### 2. å®¹å™¨å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs airline-frontend

# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker ps -a | grep airline-frontend
```

#### 3. ç½‘ç»œè¿æ¥é—®é¢˜
```bash
# æ£€æŸ¥ç½‘ç»œ
docker network ls
docker network inspect airline-network

# æµ‹è¯•åç«¯è¿æ¥
curl http://18.116.240.81:8080/api/flights
```

#### 4. æƒé™é—®é¢˜
```bash
# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la /opt/airline-order/

# ä¿®å¤æƒé™
sudo chown -R ec2-user:ec2-user /opt/airline-order/
```

## ğŸ”„ CI/CD é›†æˆ

### GitHub Actions å·¥ä½œæµï¼š

```yaml
name: å‰ç«¯éƒ¨ç½²

on:
  push:
    branches: [ main ]
    paths: [ 'frontend/**' ]

jobs:
  deploy-frontend:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    
    - name: é…ç½®AWSå‡­è¯
      uses: aws-actions/configure-aws-credentials@v2
      with:
        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
        aws-region: us-east-2
    
    - name: æ‰§è¡Œå®‰å…¨éƒ¨ç½²
      run: ./safe-frontend-deploy.sh
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. æ„å»ºä¼˜åŒ–
- **ä»£ç åˆ†å‰²**ï¼šä½¿ç”¨Angularçš„æ‡’åŠ è½½
- **èµ„æºå‹ç¼©**ï¼šå¯ç”¨gzipå‹ç¼©
- **ç¼“å­˜ç­–ç•¥**ï¼šé…ç½®é€‚å½“çš„ç¼“å­˜å¤´

### 2. è¿è¡Œæ—¶ä¼˜åŒ–
- **CDNé›†æˆ**ï¼šä½¿ç”¨CloudFrontåŠ é€Ÿ
- **è´Ÿè½½å‡è¡¡**ï¼šå¤šå®ä¾‹éƒ¨ç½²
- **ç›‘æ§å‘Šè­¦**ï¼šé›†æˆCloudWatch

## ğŸ” å®‰å…¨é…ç½®

### 1. ç½‘ç»œå®‰å…¨
- **HTTPSé…ç½®**ï¼šä½¿ç”¨SSLè¯ä¹¦
- **CORSè®¾ç½®**ï¼šé™åˆ¶è·¨åŸŸè®¿é—®
- **å®‰å…¨å¤´**ï¼šé…ç½®å®‰å…¨å“åº”å¤´

### 2. å®¹å™¨å®‰å…¨
- **æœ€å°æƒé™**ï¼šä½¿ç”¨érootç”¨æˆ·
- **é•œåƒæ‰«æ**ï¼šå®šæœŸæ‰«æå®‰å…¨æ¼æ´
- **ç§˜é’¥ç®¡ç†**ï¼šä½¿ç”¨AWS Secrets Manager

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—
2. æ£€æŸ¥å¥åº·æ£€æŸ¥çŠ¶æ€
3. ä½¿ç”¨å›æ»šåŠŸèƒ½æ¢å¤æœåŠ¡
4. è”ç³»æŠ€æœ¯æ”¯æŒ

---

**æ³¨æ„**ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨Dockeré•œåƒæ–¹å¼éƒ¨ç½²ï¼Œç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
